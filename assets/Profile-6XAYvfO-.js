import{G as ge,n as e,o as H,U as W,k as v,y as F,V as I,L as N,B as R,p as L,C,h as x,l as Pe,W as se,j as ie,X as g,A,O as be,Q as ve,Y as Ne,Z as ne,$ as S,a0 as ye,a1 as Le,N as B,a2 as Ce,a3 as oe,r as we,a4 as E}from"./index-DtG4geWC.js";import{a as P,O as xe,D as $e,C as Re,H as Ie,U as Ue}from"./DisplayPost-CQYHp5Yk.js";import"./useTimeout-CRUf8Ghs.js";function De(i){return ge({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M112 112l20 320c.95 18.49 14.4 32 32 32h184c17.67 0 30.87-13.51 32-32l20-320"}},{tag:"path",attr:{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"32",d:"M80 112h352"}},{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M192 112V72h0a23.93 23.93 0 0124-24h80a23.93 23.93 0 0124 24h0v40m-64 64v224m-72-224l8 224m136-224l-8 224"}}]})(i)}const M=i=>{const{width:t,height:n,index:s,userID:o,photo:r,onClick:a,className:l,useStoragePath:u}=i;let m;return u==="true"?m=r:m=`/${o}/${r.fileName}`,e("div",{className:l,style:{display:"inline-block",position:"relative",width:`${t}`,height:"0px",paddingBottom:`${n}`},children:e(H,{alt:"",id:s,storagePath:m,style:{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",objectFit:"cover"},onClick:a})},s)},Se=i=>{const{url:t}=W(),{userID:n,openFileInput:s,linkHandling:o}=i,{linkRefs:r,linkState:a}=o,l=r.photos,[u,m]=a,k=v(p=>p.users),h=v(p=>p.user.id),f=n===h,y=k.find(p=>p.userID===n).photos;return F(()=>{I({currentTarget:l.current},u,m)},[u,l,m]),e(P,{variant:"light",className:"w-100",children:e(P.Body,{children:[e(P.Title,{children:[e(N,{to:t,className:"text-body",children:e("b",{children:"Photos"})}),f&&e(R,{variant:"link",style:{textDecoration:"none",float:"right"},onClick:s,children:e("b",{children:"Add Photos"})})]}),e(L,{className:"w-100",children:y.map((p,w)=>e(C,{xs:6,sm:4,md:3,lg:2,className:"p-1",children:e(N,{to:`/fakebook-ainiro/photo/${n}/${w}`,children:e(M,{width:"100%",height:"100%",userID:n,photo:p,index:w})})},w))})]})})},Be=i=>{const{user:t}=i,n=`${t.firstname} ${t.lastname}`,[s,o]=x(!1),r=Pe();function a(){r.push(t.index&&t.index>0?`/fakebook-ainiro/${t.lastname}.${t.firstname}.${t.index}`:`/fakebook-ainiro/${t.lastname}.${t.firstname}`)}return e(C,{xs:6,className:"my-3",children:[e(xe,{placement:"auto",show:s,overlay:e("div",{className:"popup-card",onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),onClick:a,children:[e("div",{className:"m-3",children:e(se,{size:"120",url:t.profilePictureURL})}),e("h4",{className:"name-tag",children:e("b",{children:n})})]}),children:e("button",{type:"button",onClick:a,className:"friend-btn",tabIndex:"-1",children:e(H,{storagePath:t.profilePictureURL,width:"90px",height:"90px",alt:"",className:"profile-picture",onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1)})})}),e("button",{type:"button",className:"ml-3 friend-btn",onClick:a,children:e("b",{children:n})})]})},He=i=>{const{url:t}=W(),{linkHandling:n}=i,{linkRefs:s,linkState:o}=n,[r,a]=o,l=s.friends,u=v(k=>k.users);F(()=>{I({currentTarget:l.current},r,a)},[r,l,a]);let m;return u?m=u:m=[],e(P,{children:e(P.Body,{children:[e(P.Title,{children:e(N,{to:t,className:"text-body",children:e("b",{children:"Friends"})})}),e(L,{children:m.map((k,h)=>e(Be,{user:k},h))})]})})},Fe=i=>{const{user:t,userID:n,linkHandling:s,...o}=i,{linkRefs:r,linkState:a}=s,[l,u]=a,{photos:m}=r,k=t.photos,h=9,f=`/fakebook-ainiro/${t.lastname}.${t.firstname}/Photos`;function c(){I({currentTarget:m.current},l,u)}return e(P,{...o,children:e(P.Body,{children:[e(P.Title,{children:e(N,{to:f,className:"text-body",onClick:c,children:e("b",{children:"Photos"})})}),e(L,{children:k.map((y,p)=>p<h&&e(C,{xs:4,className:"m-0",style:{paddingLeft:"3px",paddingRight:"3px",paddingTop:"0",paddingBottom:"0"},children:e(N,{to:`/fakebook-ainiro/photo/${n}/${p}`,className:"text-body",onClick:c,tabIndex:"-1",children:e(M,{photo:y,userID:n,index:p,width:"100%",height:"100%"})})},p))})]})})},Me=i=>{const{user:t,linkHandling:n,...s}=i,{linkRefs:o,linkState:r}=n,[a,l]=r,{friends:u}=o,m=9,k=t.index&&t.index>0?`/fakebook-ainiro/${t.lastname}.${t.firstname}.${t.index}/Friends`:`/fakebook-ainiro/${t.lastname}.${t.firstname}/Friends`;function h(){I({currentTarget:u.current},a,l)}const f=v(c=>c.users);return e(P,{...s,children:e(P.Body,{children:[e(P.Title,{children:e(N,{to:k,className:"text-body",onClick:h,children:e("b",{children:"Friends"})})}),e(P.Subtitle,{className:"text-muted",children:[f.length," friends"]}),e(L,{children:f.map((c,y)=>{const p=c.index&&c.index>0?`/fakebook-ainiro/${c.lastname}.${c.firstname}.${c.index}`:`/fakebook-ainiro/${c.lastname}.${c.firstname}`,w=`${c.firstname} ${c.lastname}`;return y<m&&e(C,{xs:4,className:"m-0",style:{paddingLeft:"3px",paddingRight:"3px",paddingTop:"0",paddingBottom:"3px"},children:[e(M,{photo:c.profilePictureURL,width:"100%",height:"100%",useStoragePath:"true"}),e(N,{to:p,className:"text-body",onClick:h,children:e("div",{className:"w-100",style:{height:"2.5em"},children:e("p",{style:{fontSize:"0.9em"},children:e("b",{children:w})})})})]},y)})})]})})},Te=i=>{const{postID:t}=i,s=v(o=>o.posts).find(o=>o.postID===t);return e($e,{post:s})},re=i=>{const{userID:t,linkHandling:n}=i,{linkRefs:s,linkState:o}=n,[r,a]=o,{posts:l}=s,u=v(f=>f.users),m=v(f=>f.user.id),k=t===m,h=u.find(f=>f.userID===t);return F(()=>{I({currentTarget:l.current},r,a)},[r,l,a]),e(L,{className:"w-100 posts",children:[e(C,{sm:5,className:"mh-100 overflow-hidden",children:[e(Fe,{user:h,userID:t,linkHandling:n,className:"my-2"}),e(Me,{user:h,linkHandling:n,className:"my-2"})]}),e(C,{sm:7,className:"mh-100 overflow-auto hide-scrollbar bg-200",children:[e(Re,{firstname:h.firstname,isCurrentUser:k,className:"mt-2"}),h.posts.map((f,c)=>e(Te,{postID:f,className:"mx-auto my-2"},c))]})]})},Oe=i=>{const{itemId:t}=ie(),{userID:n,openFileInput:s,linkHandling:o}=i;return t==="Photos"?e(Se,{userID:n,openFileInput:s,linkHandling:o}):t==="Friends"?e(He,{linkHandling:o}):e(re,{userID:n,linkHandling:o})},ze=i=>{const{show:t,removeCoverPhoto:n,closeDlg:s}=i;return e(g,{show:t,onHide:s,children:[e(g.Header,{closeButton:!0,children:e(g.Title,{children:e("strong",{className:"fs-2",children:"Remove Cover Photo"})})}),e(g.Body,{children:e("div",{children:"Do you really want to remove the cover photo?"})}),e(g.Footer,{children:[e(R,{variant:"link",style:{textDecoration:"none"},onClick:s,children:e("b",{children:"Cancel"})}),e(R,{variant:"primary",onClick:n,children:e("b",{children:"Submit"})})]})]})},je=i=>{const{show:t,onHide:n,onPhotoClick:s,userID:o,photos:r}=i;return e(g,{show:t,onHide:n,scrollable:!0,children:[e(g.Header,{closeButton:!0,children:e(g.Title,{style:{marginLeft:"35%"},children:e("strong",{children:"Select Photo"})})}),e(g.Body,{children:r.map((a,l)=>e(H,{className:"m-1",width:"31%",height:"90px",alt:"",id:l,storagePath:`/${o}/${a.fileName}`,style:{objectFit:"cover"},onClick:s},l))})]})},Ae=i=>{const{show:t,onHide:n,onBtnClick:s,onPhotoClick:o,userID:r,photos:a}=i;return e(g,{show:t,onHide:n,size:"lg",scrollable:!0,children:[e(g.Header,{closeButton:!0,children:e(g.Title,{style:{margin:"auto"},children:e("strong",{children:"Update Profile Picture"})})}),e(g.Body,{children:[e(R,{size:"sm",variant:"outline-primary",className:"w-50 m-2 mb-3",onClick:s,children:e("b",{children:"+ Upload Photo"})}),e("br",{}),e("b",{children:"Suggested Photos"}),e(L,{className:"m-1",children:a.map((l,u)=>e(M,{width:"15%",height:"15%",userID:r,photo:l,index:u,onClick:o,className:"m-1"},u))})]})]})},Ke=()=>{const{userName:i}=ie(),t=v(d=>d.user.id),n=v(d=>d.users),s=v(d=>d.link),o=()=>{const $=n.map(b=>!b.index||b.index===0?`${b.lastname}.${b.firstname}`:`${b.lastname}.${b.firstname}.${b.index}`).indexOf(i);return n[$]},r=()=>o().userID,a=t===r();let{firstname:l,lastname:u,profilePictureURL:m,backgroundPictureURL:k,photos:h}=o();const[f,c]=x(!1),[y,p]=x(!1),[w,_]=x(!1),[ae,K]=x(!1),[G,le]=x("backgroundPictureURL"),[ce,de]=x(null),V=A(null),Q=A(null),X=A(null),Y={linkRefs:{photos:V,friends:Q,posts:X},linkState:[ce,de]},{url:T,path:Z}=W();function O(d){le(d),K(!0)}function z(d){switch(d){case"3":c(!0);break;case"2":O("backgroundPictureURL");break;case"1":p(!0);break;default:return}}function q(){c(!1)}function he(){return q(),E({backgroundPictureURL:"background-server.jpg"})}function J(){p(!1)}function ue(d){J(),ee(d,"backgroundPictureURL")}function j(){_(!1)}function me(){j(),O("profilePictureURL")}function pe(d){j(),ee(d,"profilePictureURL")}function fe(d){const $={fileName:d.name},U=h.map(ke=>ke.fileName),b=[...h];U.indexOf(d.name)===-1&&b.push($);const D={photos:b};return G!==""&&(D[G]=`${t}/${d.name}`),E(D)}function ee(d,$){const U=Number(d.target.id),b=h[U],D=`${t}/${b.fileName}`;return E({[$]:D})}const te=be();return F(()=>{(s.active!=="friends"||window.innerWidth<600)&&te(ve("profile"))},[te,s]),e(we,{children:[e(L,{className:"justify-content-center grad",children:e(C,{className:"m-0 p-0 profile-col",children:[e("div",{className:"background-pic-container",children:[e(H,{className:"background-pic",storagePath:k,alt:""}),a&&e(Ne,{variant:"light",className:"background-pic-button",title:e("b",{children:[e(ne,{className:"mr-1",size:"20px"}),e("span",{children:"Edit Cover Photo"})]}),size:"sm",children:[e(S.Item,{eventKey:"1",onSelect:z,children:[e(Ie,{size:"20px",className:"mr-2"}),"Select Photo"]}),e(S.Item,{eventKey:"2",onSelect:z,children:[e(ye,{size:"20px",className:"mr-2"}),"Upload Photo"]}),e(S.Divider,{}),e(S.Item,{eventKey:"3",onSelect:z,children:[e(De,{size:"20px",className:"mr-2"})," Remove"]})]}),e("div",{className:"profile-pic-container",children:[e(se,{size:"180",url:m}),a&&e(R,{variant:"light",className:"profile-pic-button",onClick:()=>_(!0),children:e(ne,{size:"19px","aria-label":"photo"})})]})]}),e("h2",{className:"text-center mt-5",children:e("b",{children:[l," ",u]})}),e("hr",{}),e(Le,{bg:"light",children:e(B,{children:[e(B.Item,{children:e(N,{to:`${T}/Posts`,className:"nav-link mx-2",ref:X,children:e("b",{children:"Posts"})},"1")}),e(B.Item,{children:e(N,{to:`${T}/Friends`,className:"nav-link mx-2",ref:Q,children:[e("b",{children:"Friends"})," ",n.length]},"2")}),e(B.Item,{children:e(N,{to:`${T}/Photos`,className:"nav-link mx-2",ref:V,children:e("b",{children:"Photos"})},"3")})]})})]})}),e(L,{className:"justify-content-center",children:e(C,{className:"profile-col",children:e(Ce,{children:[e(oe,{path:`${Z}/:itemId`,children:e(Oe,{userID:r(),openFileInput:()=>O(""),linkHandling:Y})}),e(oe,{path:Z,children:e(re,{userID:r(),linkHandling:Y})})]})})}),e(ze,{show:f,removeCoverPhoto:he,closeDlg:q}),e(je,{show:y,onHide:J,onPhotoClick:ue,userID:t,photos:h}),e(Ae,{show:w,onHide:j,onBtnClick:me,onPhotoClick:pe,userID:t,photos:h}),e(Ue,{show:ae,setShow:K,updateDatabase:fe,userID:t})]})};export{Ke as default};
